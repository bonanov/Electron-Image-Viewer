!function(t){var e={};function r(n){if(e[n])return e[n].exports;var a=e[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=4)}([function(t,e){t.exports=sharp},function(t,e){t.exports=fs},function(t,e){t.exports=gm},function(t,e){t.exports=stackblur},function(t,e,r){"use strict";r.r(e);var n=r(0),a=r.n(n),i=(r(3),r(2)),s=r.n(i),o=r(1),h=r.n(o);
/*! Fast Average Color | Â© 2019 Denis Seleznev | MIT License | https://github.com/hcodes/fast-average-color/ */
function c(t,e,r){const n={};for(let a=0;a<e;a+=r){let e=t[a],r=t[a+1],i=t[a+2],s=t[a+3],o=Math.round(e/24)+","+Math.round(r/24)+","+Math.round(i/24);n[o]?n[o]=[n[o][0]+e*s,n[o][1]+r*s,n[o][2]+i*s,n[o][3]+s,n[o][4]+1]:n[o]=[e*s,r*s,i*s,s,1]}const a=Object.keys(n).map(function(t){return n[t]}).sort(function(t,e){const r=t[4],n=e[4];return r>n?-1:r===n?0:1}),[i,s,o,h,c]=a[0];return h?[Math.round(i/h),Math.round(s/h),Math.round(o/h),Math.round(h/c)]:[0,0,0,0]}function l(t,e,r){let n=0,a=0,i=0,s=0,o=0;for(let h=0;h<e;h+=r){const e=t[h+3];n+=t[h]*e,a+=t[h+1]*e,i+=t[h+2]*e,s+=e,o++}return s?[Math.round(n/s),Math.round(a/s),Math.round(i/s),Math.round(s/o)]:[0,0,0,0]}function u(t,e,r){let n=0,a=0,i=0,s=0,o=0;for(let h=0;h<e;h+=r){const e=t[h],r=t[h+1],c=t[h+2],l=t[h+3];n+=e*e*l,a+=r*r*l,i+=c*c*l,s+=l,o++}return s?[Math.round(Math.sqrt(n/s)),Math.round(Math.sqrt(a/s)),Math.round(Math.sqrt(i/s)),Math.round(s/o)]:[0,0,0,0]}const d="FastAverageColor: ";var g=class{getColorAsync(t,e){if(t.complete){const r=this.getColor(t,e);return r.error?Promise.reject(r.error):Promise.resolve(r)}return this._bindImageEvents(t,e)}getColor(t,e){e=e||{};const r=this._getDefaultColor(e),n=this._getOriginalSize(t),a=this._prepareSizeAndPosition(n,e);let i=r;if(!(a.srcWidth&&a.srcHeight&&a.destWidth&&a.destHeight))return this._outputError(e,`incorrect sizes for resource "${t.src}".`),this._prepareResult(r);if(!this._ctx&&(this._canvas=this._makeCanvas(),this._ctx=this._canvas.getContext&&this._canvas.getContext("2d"),!this._ctx))return this._outputError(e,"Canvas Context 2D is not supported in this browser."),this._prepareResult(r);this._canvas.width=a.destWidth,this._canvas.height=a.destHeight;try{this._ctx.clearRect(0,0,a.destWidth,a.destHeight),this._ctx.drawImage(t,a.srcLeft,a.srcTop,a.srcWidth,a.srcHeight,0,0,a.destWidth,a.destHeight);const r=this._ctx.getImageData(0,0,a.destWidth,a.destHeight).data;i=this.getColorFromArray4(r,e)}catch(r){this._outputError(e,`security error (CORS) for resource ${t.src}.\nDetails: https://developer.mozilla.org/en/docs/Web/HTML/CORS_enabled_image`,r)}return this._prepareResult(i)}getColorFromArray4(t,e){e=e||{};const r=t.length;if(r<4)return this._getDefaultColor(e);const n=r-r%4,a=4*(e.step||1);let i;switch(e.algorithm||"sqrt"){case"simple":i=l;break;case"sqrt":i=u;break;case"dominant":i=c;break;default:throw new Error(`${d}${e.algorithm} is unknown algorithm.`)}return i(t,n,a)}destroy(){delete this._canvas,delete this._ctx}_getDefaultColor(t){return this._getOption(t,"defaultColor",[255,255,255,255])}_getOption(t,e,r){return void 0===t[e]?r:t[e]}_prepareSizeAndPosition(t,e){let r,n=this._getOption(e,"left",0),a=this._getOption(e,"top",0),i=this._getOption(e,"width",t.width),s=this._getOption(e,"height",t.height),o=i,h=s;return"precision"===e.mode?{srcLeft:n,srcTop:a,srcWidth:i,srcHeight:s,destWidth:o,destHeight:h}:(i>s?(r=i/s,o=100,h=Math.round(o/r)):(r=s/i,h=100,o=Math.round(h/r)),(o>i||h>s||o<10||h<10)&&(o=i,h=s),{srcLeft:n,srcTop:a,srcWidth:i,srcHeight:s,destWidth:o,destHeight:h})}_bindImageEvents(t,e){return new Promise((r,n)=>{const a=()=>{o();const a=this.getColor(t,e);a.error?n(a.error):r(a)},i=()=>{o(),n(new Error(`${d}Error loading image ${t.src}.`))},s=()=>{o(),n(new Error(`${d}Image "${t.src}" loading aborted.`))},o=()=>{t.removeEventListener("load",a),t.removeEventListener("error",i),t.removeEventListener("abort",s)};t.addEventListener("load",a),t.addEventListener("error",i),t.addEventListener("abort",s)})}_prepareResult(t){const e=t.slice(0,3),r=[].concat(e,t[3]/255),n=this._isDark(t);return{value:t,rgb:"rgb("+e.join(",")+")",rgba:"rgba("+r.join(",")+")",hex:this._arrayToHex(e),hexa:this._arrayToHex(t),isDark:n,isLight:!n}}_getOriginalSize(t){return t instanceof HTMLImageElement?{width:t.naturalWidth,height:t.naturalHeight}:t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:{width:t.width,height:t.height}}_toHex(t){let e=t.toString(16);return 1===e.length?"0"+e:e}_arrayToHex(t){return"#"+t.map(this._toHex).join("")}_isDark(t){return(299*t[0]+587*t[1]+114*t[2])/1e3<128}_makeCanvas(){return"undefined"==typeof window?new OffscreenCanvas(1,1):document.createElement("canvas")}_outputError(t,e,r){t.silent||(console.error(`${d}${e}`),r&&console.error(r))}};const f=["jpg","jpeg","png","gif","webp"],p=new RegExp(/^.*\.(.{1,5})$/gim),m=(new RegExp(/(\.(jpg|png|gif|jpeg|webp|tiff))\??([^\/]*)?/gi),new g),_=async t=>{return{...await new Promise((e,r)=>{s()(t).size(async(t,r)=>{if(t)return e({err:t});e({width:r.width,height:r.height})})})}},w=t=>{return t.filter(t=>(t=>!!f.includes(t.toLowerCase()))(t.type))},y=async(t,e)=>{const r=[];return await t.forEach(async t=>{const{mtimeMs:n,atimeMs:a,ctimeMs:i}=await h.a.statSync(e+t),s=Math.floor(Math.random()*Date.now()),o=(t=>t.replace(p,"$1"))(t),c={fileName:t.replace(/\?/g,"%3F"),fullPath:(e+t).replace(/\?/g,"%3F"),url:"",dir:e.replace(/\?/g,"%3F"),size:"",mtime:n,atime:a,ctime:i,isUrl:!1,type:o,id:s};r.push(c)}),r},{ipcRenderer:b}=window.electron;b.on("asynchronous-message",async(t,e)=>{const{data:r,type:n}=e;switch(n){case"GET_PROPS":{const t={...await(async t=>{const e=await _(t),{width:r,height:n,err:a}=e;return{width:r,height:n,aspect:r/n,err:a,fullPath:t}})(r.fullPath),path:r.fullPath};b.send("asynchronous-message",(({width:t,height:e,aspect:r,fullPath:n})=>({type:"SEND_PROPS",data:{fullPath:n,width:t,height:e,aspect:r}}))(t));break}case"GET_RESIZED":{const{width:t,height:e,fullPath:n}=r,i={fullPath:n,base64:await(async({fullPath:t,width:e,height:r})=>{return await new Promise((n,i)=>{a()(t).resize(Math.round(e),Math.round(r),{fit:a.a.fit.inside,kernel:a.a.kernel.lanczos3,withoutEnlargement:!0}).png({compressionLevel:0}).toBuffer().then(t=>n("data:image/png;base64,"+t.toString("base64"))).catch(t=>i(t))})})({width:t,height:e,fullPath:n})};b.send("asynchronous-message",(({fullPath:t,base64:e})=>({type:"SEND_RESIZED",data:{fullPath:t,base64:e}}))(i));break}case"GET_BLURED":{const{width:t,height:e,fullPath:n}=r,i={fullPath:n,base64:await(async({fullPath:t,width:e,height:r})=>{return await new Promise((n,i)=>{a()(t).resize(Math.round(e),r,{fit:a.a.fit.fill,kernel:a.a.kernel.nearest,withoutEnlargement:!0}).blur(15).png({compressionLevel:0}).toBuffer().then(t=>n("data:image/jpeg;base64,"+t.toString("base64"))).catch(t=>i(t))})})({width:t,height:e,fullPath:n})};b.send("asynchronous-message",(({fullPath:t,base64:e})=>({type:"SEND_BLURED",data:{fullPath:t,base64:e}}))(i));break}case"GET_COLOR":{const{buffer:t,fullPath:e}=r,n={fullPath:e,color:await(async t=>{m.getColorFromArray4(t)})(t)};b.send("asynchronous-message",(({fullPath:t,color:e})=>({type:"SEND_COLOR",data:{fullPath:t,color:e}}))(n));break}case"GET_FILELIST":{const{dir:t}=r,e={fileList:await(async t=>{return await new Promise(e=>{h.a.readdir(t,async(r,n)=>{const a=await y(n,t),i=await w(a);e(i)})})})(t)};b.send("asynchronous-message",(({fileList:t})=>({type:"SEND_FILELIST",data:{fileList:t}}))(e));break}}})}]);